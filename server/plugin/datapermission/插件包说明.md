# 数据权限管理插件 - gin-vue-admin

## 🚀 插件简介

**数据权限管理插件**是专为 gin-vue-admin 框架开发的企业级数据权限控制解决方案。通过灵活的角色树管理、细粒度的数据范围控制和字段级权限管理，帮助企业构建安全、高效的数据访问控制体系。

### ✨ 核心特性

- 🌳 **角色树展示** - 和系统角色保持一致
- 🔐 **数据范围控制** - 全部、本部门、本部门及子部门、仅本人等多种数据范围
- 🏷️ **字段级权限** - 精确控制用户可见的数据字段
- 📊 **受控表管理** - 动态配置需要权限控制的数据表
- 🛡️ **安全防护** - 内置SQL注入检查，确保数据安全
- ⚡ **高性能缓存** - 智能缓存机制，提升权限检查效率
- 📝 **操作日志** - 完整的权限操作审计日志

## 📦 插件内容

### 后端文件结构
```
server/plugin/datapermission/
├── api/                    # API接口层
│   ├── data_permission.go  # 数据权限API
│   └── controlled_table.go # 受控表管理API
├── model/                  # 数据模型
│   ├── controlled_table.go # 受控表模型
│   ├── role_data_permission.go # 角色数据权限模型
│   └── role_field_permission.go # 角色字段权限模型
├── service/                # 业务逻辑层
│   ├── data_permission.go  # 数据权限服务
│   └── controlled_table.go # 受控表服务
├── router/                 # 路由配置
│   └── data_permission.go  # 权限路由
├── config.go              # 插件配置
└── plugin.go              # 插件注册
```

### 前端文件结构
```
web/src/plugin/datapermission/
├── api/                    # API接口
│   └── dataPermission.js  # 数据权限API
├── components/             # 组件库
│   ├── RoleTree.vue       # 角色树组件
│   └── DataPermissionConfig.vue # 权限配置组件
├── view/                   # 页面视图
│   └── index.vue          # 主页面
├── router/                 # 路由配置
│   └── index.js           # 路由定义
├── demo/                   # 使用示例
│   └── demo.vue           # 演示页面
└── README.md              # 组件文档
```

## 🛠️ 技术规格

### 环境要求
- **后端**: Go 1.19+, gin-vue-admin v2.5.0+
- **前端**: Vue 3.0+, Element Plus 2.0+
- **数据库**: MySQL 5.7+ / PostgreSQL 12+ / SQLite 3.0+

### 兼容性
- ✅ gin-vue-admin v2.5.0+
- ✅ Vue 3.x
- ✅ Element Plus 2.x
- ✅ MySQL / PostgreSQL / SQLite

## 📋 功能清单

### 数据权限管理
- [x] 角色树结构管理
- [x] 数据范围配置（全部/本部门/本部门及子部门/仅本人/自定义）
- [x] 字段级权限控制
- [x] 动态SQL权限过滤
- [x] 权限缓存机制

### 受控表管理
- [x] 数据表动态注册
- [x] 表字段权限配置
- [x] 用户字段和部门字段映射
- [x] 表级权限开关

### 安全特性
- [x] SQL注入防护
- [x] 权限操作日志
- [x] 敏感操作审计
- [x] 权限缓存安全

### 用户界面
- [x] 直观的角色树管理界面
- [x] 可视化权限配置面板
- [x] 实时权限预览
- [x] 批量权限操作

## 🚀 快速安装

### 方式一：自动安装（推荐）

1. **下载插件包**


2. **插件安装**
 

3. **启动服务**
   ```bash
   # 后端
   cd server && go run main.go
   
   # 前端
   cd web && npm run serve
   ```

### 方式二：手动安装

详细的手动安装步骤请参考：`数据权限管理插件使用手册.md`

## 📖 使用文档

- 📘 **完整使用手册**: `数据权限管理插件使用手册.md`
- 🚀 **快速开始指南**: `数据权限插件快速开始指南.md`
- 🎯 **演示示例**: `web/src/plugin/datapermission/demo/demo.vue`
- 🔧 **API文档**: 插件内置 Swagger 文档

## 🎯 使用场景

### 企业管理系统
- **人事管理**: 不同角色查看不同范围的员工信息
- **财务系统**: 按部门控制财务数据访问权限
- **客户管理**: 销售人员只能查看自己的客户数据

### 政府机构
- **政务系统**: 按行政级别控制数据访问范围
- **审批流程**: 不同岗位查看不同的审批信息
- **统计报表**: 按权限显示不同维度的统计数据

## 🔧 配置示例

### 基础配置
```yaml
# config.yaml
data-permission:
  enabled: true
  default-data-scope: "dept"
  field-permission-enabled: true
  sql-injection-check: true
  cache:
    enabled: true
    expiration: 3600
  log:
    enabled: true
    level: "info"
```

### 前端路由配置
```javascript
// router/index.js
import DataPermissionRouter from '@/plugin/datapermission/router/index'

const routes = [
  {
    path: '/admin',
    component: Layout,
    children: [DataPermissionRouter]
  }
]
```

## 🧪 测试验证

插件包含完整的测试用例和演示示例：

1. **功能测试**: 运行 `web/test_datapermission.js`
2. **界面演示**: 访问 `/datapermission/demo`
3. **API测试**: 使用内置 Swagger 文档


### 常见问题

**Q: 插件安装后无法访问页面？**
A: 请检查路由配置是否正确，确保已添加插件路由到主路由文件中。

**Q: 权限配置不生效？**
A: 请检查缓存配置，尝试清除权限缓存后重新测试。

**Q: 数据库迁移失败？**
A: 请确保数据库连接正常，用户具有创建表的权限。






